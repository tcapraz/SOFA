<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Analysis of TCGA breast cancer dataset &mdash; spfa 0.1 documentation</title>
      <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
        <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Analysis of multi-omics data of chronic lymphocytic leukemia patients" href="cll_data.html" />
    <link rel="prev" title="Installation" href="installation.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../index.html" class="icon icon-home"> spfa
          </a>
              <div class="version">
                0.1.0
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">API:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../spfa.html">spFA</a></li>
<li class="toctree-l1"><a class="reference internal" href="../plots.html">plots</a></li>
<li class="toctree-l1"><a class="reference internal" href="../utils.html">tools</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Tutorials:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Analysis of TCGA breast cancer dataset</a></li>
<li class="toctree-l1"><a class="reference internal" href="cll_data.html">Analysis of multi-omics data of chronic lymphocytic leukemia patients</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">spfa</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
      <li>Analysis of TCGA breast cancer dataset</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/notebooks/tcga_data.ipynb.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  
<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput.container div.prompt *,
div.nboutput.container div.prompt *,
div.nbinput.container div.input_area pre,
div.nboutput.container div.output_area pre,
div.nbinput.container div.input_area .highlight,
div.nboutput.container div.output_area .highlight {
    border: none;
    padding: 0;
    margin: 0;
    box-shadow: none;
}

div.nbinput.container > div[class*=highlight],
div.nboutput.container > div[class*=highlight] {
    margin: 0;
}

div.nbinput.container div.prompt *,
div.nboutput.container div.prompt * {
    background: none;
}

div.nboutput.container div.output_area .highlight,
div.nboutput.container div.output_area pre {
    background: unset;
}

div.nboutput.container div.output_area div.highlight {
    color: unset;  /* override Pygments text color */
}

/* avoid gaps between output lines */
div.nboutput.container div[class*=highlight] pre {
    line-height: normal;
}

/* input/output containers */
div.nbinput.container,
div.nboutput.container {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
    width: 100%;
}
@media (max-width: 540px) {
    div.nbinput.container,
    div.nboutput.container {
        flex-direction: column;
    }
}

/* input container */
div.nbinput.container {
    padding-top: 5px;
}

/* last container */
div.nblast.container {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput.container div.prompt pre {
    color: #307FC1;
}

/* output prompt */
div.nboutput.container div.prompt pre {
    color: #BF5B3D;
}

/* all prompts */
div.nbinput.container div.prompt,
div.nboutput.container div.prompt {
    width: 4.5ex;
    padding-top: 5px;
    position: relative;
    user-select: none;
}

div.nbinput.container div.prompt > div,
div.nboutput.container div.prompt > div {
    position: absolute;
    right: 0;
    margin-right: 0.3ex;
}

@media (max-width: 540px) {
    div.nbinput.container div.prompt,
    div.nboutput.container div.prompt {
        width: unset;
        text-align: left;
        padding: 0.4em;
    }
    div.nboutput.container div.prompt.empty {
        padding: 0;
    }

    div.nbinput.container div.prompt > div,
    div.nboutput.container div.prompt > div {
        position: unset;
    }
}

/* disable scrollbars on prompts */
div.nbinput.container div.prompt pre,
div.nboutput.container div.prompt pre {
    overflow: hidden;
}

/* input/output area */
div.nbinput.container div.input_area,
div.nboutput.container div.output_area {
    -webkit-flex: 1;
    flex: 1;
    overflow: auto;
}
@media (max-width: 540px) {
    div.nbinput.container div.input_area,
    div.nboutput.container div.output_area {
        width: 100%;
    }
}

/* input area */
div.nbinput.container div.input_area {
    border: 1px solid #e0e0e0;
    border-radius: 2px;
    /*background: #f5f5f5;*/
}

/* override MathJax center alignment in output cells */
div.nboutput.container div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.imgmath center alignment in output cells */
div.nboutput.container div.math p {
    text-align: left;
}

/* standard error */
div.nboutput.container div.output_area.stderr {
    background: #fdd;
}

/* ANSI colors */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-default-inverse-fg { color: #FFFFFF; }
.ansi-default-inverse-bg { background-color: #000000; }

.ansi-bold { font-weight: bold; }
.ansi-underline { text-decoration: underline; }


div.nbinput.container div.input_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight].math,
div.nboutput.container div.output_area.rendered_html,
div.nboutput.container div.output_area > div.output_javascript,
div.nboutput.container div.output_area:not(.rendered_html) > img{
    padding: 5px;
    margin: 0;
}

/* fix copybtn overflow problem in chromium (needed for 'sphinx_copybutton') */
div.nbinput.container div.input_area > div[class^='highlight'],
div.nboutput.container div.output_area > div[class^='highlight']{
    overflow-y: hidden;
}

/* hide copybtn icon on prompts (needed for 'sphinx_copybutton') */
.prompt .copybtn {
    display: none;
}

/* Some additional styling taken form the Jupyter notebook CSS */
.jp-RenderedHTMLCommon table,
div.rendered_html table {
  border: none;
  border-collapse: collapse;
  border-spacing: 0;
  color: black;
  font-size: 12px;
  table-layout: fixed;
}
.jp-RenderedHTMLCommon thead,
div.rendered_html thead {
  border-bottom: 1px solid black;
  vertical-align: bottom;
}
.jp-RenderedHTMLCommon tr,
.jp-RenderedHTMLCommon th,
.jp-RenderedHTMLCommon td,
div.rendered_html tr,
div.rendered_html th,
div.rendered_html td {
  text-align: right;
  vertical-align: middle;
  padding: 0.5em 0.5em;
  line-height: normal;
  white-space: normal;
  max-width: none;
  border: none;
}
.jp-RenderedHTMLCommon th,
div.rendered_html th {
  font-weight: bold;
}
.jp-RenderedHTMLCommon tbody tr:nth-child(odd),
div.rendered_html tbody tr:nth-child(odd) {
  background: #f5f5f5;
}
.jp-RenderedHTMLCommon tbody tr:hover,
div.rendered_html tbody tr:hover {
  background: rgba(66, 165, 245, 0.2);
}

/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<section id="Analysis-of-TCGA-breast-cancer-dataset">
<h1>Analysis of TCGA breast cancer dataset<a class="headerlink" href="#Analysis-of-TCGA-breast-cancer-dataset" title="Permalink to this headline"></a></h1>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>import sofa
import torch
import pandas as pd
import numpy as np
import matplotlib.pyplot as plt
from sklearn.decomposition import PCA
import seaborn as sns
import matplotlib
from sklearn.preprocessing import StandardScaler
from muon import MuData
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
/home/tuemay/anaconda3/envs/spFA/lib/python3.11/site-packages/tqdm/auto.py:21: TqdmWarning: IProgress not found. Please update jupyter and ipywidgets. See https://ipywidgets.readthedocs.io/en/stable/user_install.html
  from .autonotebook import tqdm as notebook_tqdm
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>torch.manual_seed(0)
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&lt;torch._C.Generator at 0x7fd0b01079b0&gt;
</pre></div></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span># read data
rna = pd.read_csv(&quot;data/tcga_data/train_rna.csv&quot;, index_col=0)
mirna = pd.read_csv(&quot;data/tcga_data/train_mirna.csv&quot;, index_col=0)
prot = pd.read_csv(&quot;data/tcga_data/train_prot.csv&quot;, index_col=0)
meth = pd.read_csv(&quot;data/tcga_data/train_meth.csv&quot;, index_col=0)
subtype = pd.read_csv(&quot;data/tcga_data/train_y.csv&quot;, index_col=0)

# scale and center train data
scaler = StandardScaler()
rna = pd.DataFrame(scaler.fit_transform(rna), columns = rna.columns)
meth = pd.DataFrame(scaler.fit_transform(meth), columns = meth.columns)
mirna = pd.DataFrame(scaler.fit_transform(mirna), columns = mirna.columns)
prot = pd.DataFrame(scaler.fit_transform(prot), columns = prot.columns)

# all views have gaussian distribution
data = [rna, meth, mirna, prot]
llh = [&quot;gaussian&quot;, &quot;gaussian&quot;, &quot;gaussian&quot;, &quot;gaussian&quot;]
views = [&quot;mrna&quot;, &quot;methylation&quot;, &quot;mirna&quot;, &quot;proteomics&quot;]
<br/></pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><br/><span></span>adata = [sofa.tl.get_ad(data[i], llh[i]) for i in range(len(data))]
Xmdata = MuData({views[i]:adata[i] for i in range(len(adata))})
Xmdata
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
/home/tuemay/anaconda3/envs/spFA/lib/python3.11/site-packages/mudata/_core/mudata.py:491: UserWarning: Cannot join columns with the same name because var_names are intersecting.
  warnings.warn(
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<pre>MuData object with n_obs × n_vars = 379 × 4326
  4 modalities
    mrna:   379 x 2000
      uns:  &#x27;llh&#x27;
      obsm: &#x27;mask&#x27;
    methylation:    379 x 2000
      uns:  &#x27;llh&#x27;
      obsm: &#x27;mask&#x27;
    mirna:  379 x 184
      uns:  &#x27;llh&#x27;
      obsm: &#x27;mask&#x27;
    proteomics:     379 x 142
      uns:  &#x27;llh&#x27;
      obsm: &#x27;mask&#x27;</pre></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>subtype_ad = sofa.tl.get_ad(subtype, &quot;multinomial&quot;)
Ymdata = MuData({&quot;subtype&quot;:subtype_ad})
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><br/><span></span># convert string labels to numeric
label_map = {lab:i for i,lab in enumerate(np.unique(subtype[&quot;x&quot;]))}
y = np.array([label_map[i] for i in subtype[&quot;x&quot;]])

# define colors for target classes
cblind_colors = sns.color_palette(&quot;colorblind&quot;, as_cmap=True)[0:4]
subtypes = [&quot;LumA&quot;, &quot;Basal&quot;,  &quot;Her2&quot;, &quot;LumB&quot;]

# plot pca of concatenated views
pca = PCA(2).fit_transform(np.hstack(data))
fig, ax = plt.subplots(1)
for i,sub in enumerate(subtypes):
    plot = ax.scatter(pca[subtype[&quot;x&quot;].values==sub,0],pca[subtype[&quot;x&quot;].values==sub,1], color=cblind_colors[i], label=sub)
ax.set_aspect(&#39;equal&#39;)
ax.set_aspect(&#39;equal&#39;)
plt.xlabel(&quot;PC 1&quot;)
plt.ylabel(&quot;PC 2&quot;)
plt.legend(loc=&#39;center left&#39;, bbox_to_anchor=(1, 0.5))
plt.tight_layout()
plt.show()
plt.close()
<br/></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_tcga_data_6_0.png" src="../_images/notebooks_tcga_data_6_0.png" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>num_factors = 5
design = np.zeros((len(Ymdata.mod), num_factors))
design[0,0:2] = 1
design
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
array([[1., 1., 0., 0., 0.]])
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span># set up model and fit
model = sofa.SOFA(Xmdata,
            num_factors=5,
            Ymdata=Ymdata,
            design= torch.tensor(design),
            device=torch.device(&#39;cpu&#39;),
            ard=True,
            horseshoe=True)
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
/home/tuemay/anaconda3/envs/spFA/lib/python3.11/site-packages/spfa/models/spFA.py:120: FutureWarning: Series.__getitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To access a value by position, use `ser.iloc[pos]`
  mask.append(torch.tensor(self.Xmdata.mod[i].obsm[&#34;mask&#34;]).to(self.device))
/home/tuemay/anaconda3/envs/spFA/lib/python3.11/site-packages/spfa/models/spFA.py:143: FutureWarning: Series.__getitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To access a value by position, use `ser.iloc[pos]`
  mask.append(torch.tensor(self.Ymdata.mod[i].obsm[&#34;mask&#34;]).to(self.device))
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>model.fit(n_steps=1000, lr=0.01)
<br/></pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
Current Elbo 6.92E+06 | Delta: inf:   5%|▌         | 54/1000 [00:07&lt;02:13,  7.10it/s]
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">KeyboardInterrupt</span>                         Traceback (most recent call last)
<span class="ansi-green-intense-fg ansi-bold">/home/tuemay/supervised_matrix_factorization/spFA/docs/notebooks/tcga_data.ipynb Cell 10</span> line <span class="ansi-cyan-fg">1
</span><span class="ansi-green-fg">----&gt; &lt;a href=&#39;vscode-notebook-cell:/home/tuemay/supervised_matrix_factorization/spFA/docs/notebooks/tcga_data.ipynb#X12sZmlsZQ%3D%3D?line=0&#39;&gt;1&lt;/a&gt;</span> model.fit(n_steps=1000, lr=0.01)

File <span class="ansi-green-fg">~/anaconda3/envs/spFA/lib/python3.11/site-packages/spfa/models/spFA.py:352</span>, in <span class="ansi-cyan-fg">spFA.fit</span><span class="ansi-blue-fg">(self, n_steps, lr, refit, predict)</span>
<span class="ansi-green-intense-fg ansi-bold">    350</span> # do gradient steps
<span class="ansi-green-intense-fg ansi-bold">    351</span> for step in pbar:
<span class="ansi-green-fg">--&gt; 352</span>     loss = self.svi.step(idx=self.idx, subsample=self.subsample)
<span class="ansi-green-intense-fg ansi-bold">    353</span>     # track loss
<span class="ansi-green-intense-fg ansi-bold">    354</span>     self.history.append(loss)

File <span class="ansi-green-fg">~/anaconda3/envs/spFA/lib/python3.11/site-packages/pyro/infer/svi.py:145</span>, in <span class="ansi-cyan-fg">SVI.step</span><span class="ansi-blue-fg">(self, *args, **kwargs)</span>
<span class="ansi-green-intense-fg ansi-bold">    143</span> # get loss and compute gradients
<span class="ansi-green-intense-fg ansi-bold">    144</span> with poutine.trace(param_only=True) as param_capture:
<span class="ansi-green-fg">--&gt; 145</span>     loss = self.loss_and_grads(self.model, self.guide, *args, **kwargs)
<span class="ansi-green-intense-fg ansi-bold">    147</span> params = set(
<span class="ansi-green-intense-fg ansi-bold">    148</span>     site[&#34;value&#34;].unconstrained() for site in param_capture.trace.nodes.values()
<span class="ansi-green-intense-fg ansi-bold">    149</span> )
<span class="ansi-green-intense-fg ansi-bold">    151</span> # actually perform gradient steps
<span class="ansi-green-intense-fg ansi-bold">    152</span> # torch.optim objects gets instantiated for any params that haven&#39;t been seen yet

File <span class="ansi-green-fg">~/anaconda3/envs/spFA/lib/python3.11/site-packages/pyro/infer/trace_elbo.py:140</span>, in <span class="ansi-cyan-fg">Trace_ELBO.loss_and_grads</span><span class="ansi-blue-fg">(self, model, guide, *args, **kwargs)</span>
<span class="ansi-green-intense-fg ansi-bold">    138</span> loss = 0.0
<span class="ansi-green-intense-fg ansi-bold">    139</span> # grab a trace from the generator
<span class="ansi-green-fg">--&gt; 140</span> for model_trace, guide_trace in self._get_traces(model, guide, args, kwargs):
<span class="ansi-green-intense-fg ansi-bold">    141</span>     loss_particle, surrogate_loss_particle = self._differentiable_loss_particle(
<span class="ansi-green-intense-fg ansi-bold">    142</span>         model_trace, guide_trace
<span class="ansi-green-intense-fg ansi-bold">    143</span>     )
<span class="ansi-green-intense-fg ansi-bold">    144</span>     loss += loss_particle / self.num_particles

File <span class="ansi-green-fg">~/anaconda3/envs/spFA/lib/python3.11/site-packages/pyro/infer/elbo.py:236</span>, in <span class="ansi-cyan-fg">ELBO._get_traces</span><span class="ansi-blue-fg">(self, model, guide, args, kwargs)</span>
<span class="ansi-green-intense-fg ansi-bold">    234</span> else:
<span class="ansi-green-intense-fg ansi-bold">    235</span>     for i in range(self.num_particles):
<span class="ansi-green-fg">--&gt; 236</span>         yield self._get_trace(model, guide, args, kwargs)

File <span class="ansi-green-fg">~/anaconda3/envs/spFA/lib/python3.11/site-packages/pyro/infer/trace_elbo.py:57</span>, in <span class="ansi-cyan-fg">Trace_ELBO._get_trace</span><span class="ansi-blue-fg">(self, model, guide, args, kwargs)</span>
<span class="ansi-green-intense-fg ansi-bold">     52</span> def _get_trace(self, model, guide, args, kwargs):
<span class="ansi-green-intense-fg ansi-bold">     53</span>     &#34;&#34;&#34;
<span class="ansi-green-intense-fg ansi-bold">     54</span>     Returns a single trace from the guide, and the model that is run
<span class="ansi-green-intense-fg ansi-bold">     55</span>     against it.
<span class="ansi-green-intense-fg ansi-bold">     56</span>     &#34;&#34;&#34;
<span class="ansi-green-fg">---&gt; 57</span>     model_trace, guide_trace = get_importance_trace(
<span class="ansi-green-intense-fg ansi-bold">     58</span>         &#34;flat&#34;, self.max_plate_nesting, model, guide, args, kwargs
<span class="ansi-green-intense-fg ansi-bold">     59</span>     )
<span class="ansi-green-intense-fg ansi-bold">     60</span>     if is_validation_enabled():
<span class="ansi-green-intense-fg ansi-bold">     61</span>         check_if_enumerated(guide_trace)

File <span class="ansi-green-fg">~/anaconda3/envs/spFA/lib/python3.11/site-packages/pyro/infer/enum.py:60</span>, in <span class="ansi-cyan-fg">get_importance_trace</span><span class="ansi-blue-fg">(graph_type, max_plate_nesting, model, guide, args, kwargs, detach)</span>
<span class="ansi-green-intense-fg ansi-bold">     58</span>     model_trace, guide_trace = unwrapped_guide.get_traces()
<span class="ansi-green-intense-fg ansi-bold">     59</span> else:
<span class="ansi-green-fg">---&gt; 60</span>     guide_trace = poutine.trace(guide, graph_type=graph_type).get_trace(
<span class="ansi-green-intense-fg ansi-bold">     61</span>         *args, **kwargs
<span class="ansi-green-intense-fg ansi-bold">     62</span>     )
<span class="ansi-green-intense-fg ansi-bold">     63</span>     if detach:
<span class="ansi-green-intense-fg ansi-bold">     64</span>         guide_trace.detach_()

File <span class="ansi-green-fg">~/anaconda3/envs/spFA/lib/python3.11/site-packages/pyro/poutine/trace_messenger.py:198</span>, in <span class="ansi-cyan-fg">TraceHandler.get_trace</span><span class="ansi-blue-fg">(self, *args, **kwargs)</span>
<span class="ansi-green-intense-fg ansi-bold">    190</span> def get_trace(self, *args, **kwargs):
<span class="ansi-green-intense-fg ansi-bold">    191</span>     &#34;&#34;&#34;
<span class="ansi-green-intense-fg ansi-bold">    192</span>     :returns: data structure
<span class="ansi-green-intense-fg ansi-bold">    193</span>     :rtype: pyro.poutine.Trace
<span class="ansi-green-fg">   (...)</span>
<span class="ansi-green-intense-fg ansi-bold">    196</span>     Calls this poutine and returns its trace instead of the function&#39;s return value.
<span class="ansi-green-intense-fg ansi-bold">    197</span>     &#34;&#34;&#34;
<span class="ansi-green-fg">--&gt; 198</span>     self(*args, **kwargs)
<span class="ansi-green-intense-fg ansi-bold">    199</span>     return self.msngr.get_trace()

File <span class="ansi-green-fg">~/anaconda3/envs/spFA/lib/python3.11/site-packages/pyro/poutine/trace_messenger.py:174</span>, in <span class="ansi-cyan-fg">TraceHandler.__call__</span><span class="ansi-blue-fg">(self, *args, **kwargs)</span>
<span class="ansi-green-intense-fg ansi-bold">    170</span> self.msngr.trace.add_node(
<span class="ansi-green-intense-fg ansi-bold">    171</span>     &#34;_INPUT&#34;, name=&#34;_INPUT&#34;, type=&#34;args&#34;, args=args, kwargs=kwargs
<span class="ansi-green-intense-fg ansi-bold">    172</span> )
<span class="ansi-green-intense-fg ansi-bold">    173</span> try:
<span class="ansi-green-fg">--&gt; 174</span>     ret = self.fn(*args, **kwargs)
<span class="ansi-green-intense-fg ansi-bold">    175</span> except (ValueError, RuntimeError) as e:
<span class="ansi-green-intense-fg ansi-bold">    176</span>     exc_type, exc_value, traceback = sys.exc_info()

File <span class="ansi-green-fg">~/anaconda3/envs/spFA/lib/python3.11/site-packages/spfa/models/spFA.py:306</span>, in <span class="ansi-cyan-fg">spFA._spFA_guide</span><span class="ansi-blue-fg">(self, idx, subsample)</span>
<span class="ansi-green-intense-fg ansi-bold">    304</span> if self.ard:
<span class="ansi-green-intense-fg ansi-bold">    305</span>     W_scale = pyro.sample(&#34;ard_prior_{}&#34;.format(i), dist.Delta(gamma_alpha[i] / gamma_beta[i]).to_event(1))
<span class="ansi-green-fg">--&gt; 306</span>     W = pyro.sample(&#34;W_unshrunk_{}&#34;.format(i), dist.Normal(W_loc[i], 1 / W_scale).to_event(1))
<span class="ansi-green-intense-fg ansi-bold">    307</span> else:
<span class="ansi-green-intense-fg ansi-bold">    308</span>     W = pyro.sample(&#34;W_unshrunk_{}&#34;.format(i), dist.Normal(W_loc[i], W_scale[i]).to_event(1))

File <span class="ansi-green-fg">~/anaconda3/envs/spFA/lib/python3.11/site-packages/pyro/primitives.py:163</span>, in <span class="ansi-cyan-fg">sample</span><span class="ansi-blue-fg">(name, fn, *args, **kwargs)</span>
<span class="ansi-green-intense-fg ansi-bold">    146</span> msg = {
<span class="ansi-green-intense-fg ansi-bold">    147</span>     &#34;type&#34;: &#34;sample&#34;,
<span class="ansi-green-intense-fg ansi-bold">    148</span>     &#34;name&#34;: name,
<span class="ansi-green-fg">   (...)</span>
<span class="ansi-green-intense-fg ansi-bold">    160</span>     &#34;continuation&#34;: None,
<span class="ansi-green-intense-fg ansi-bold">    161</span> }
<span class="ansi-green-intense-fg ansi-bold">    162</span> # apply the stack and return its return value
<span class="ansi-green-fg">--&gt; 163</span> apply_stack(msg)
<span class="ansi-green-intense-fg ansi-bold">    164</span> return msg[&#34;value&#34;]

File <span class="ansi-green-fg">~/anaconda3/envs/spFA/lib/python3.11/site-packages/pyro/poutine/runtime.py:218</span>, in <span class="ansi-cyan-fg">apply_stack</span><span class="ansi-blue-fg">(initial_msg)</span>
<span class="ansi-green-intense-fg ansi-bold">    215</span>     if msg[&#34;stop&#34;]:
<span class="ansi-green-intense-fg ansi-bold">    216</span>         break
<span class="ansi-green-fg">--&gt; 218</span> default_process_message(msg)
<span class="ansi-green-intense-fg ansi-bold">    220</span> for frame in stack[-pointer:]:
<span class="ansi-green-intense-fg ansi-bold">    221</span>     frame._postprocess_message(msg)

File <span class="ansi-green-fg">~/anaconda3/envs/spFA/lib/python3.11/site-packages/pyro/poutine/runtime.py:179</span>, in <span class="ansi-cyan-fg">default_process_message</span><span class="ansi-blue-fg">(msg)</span>
<span class="ansi-green-intense-fg ansi-bold">    176</span>     msg[&#34;done&#34;] = True
<span class="ansi-green-intense-fg ansi-bold">    177</span>     return msg
<span class="ansi-green-fg">--&gt; 179</span> msg[&#34;value&#34;] = msg[&#34;fn&#34;](*msg[&#34;args&#34;], **msg[&#34;kwargs&#34;])
<span class="ansi-green-intense-fg ansi-bold">    181</span> # after fn has been called, update msg to prevent it from being called again.
<span class="ansi-green-intense-fg ansi-bold">    182</span> msg[&#34;done&#34;] = True

File <span class="ansi-green-fg">~/anaconda3/envs/spFA/lib/python3.11/site-packages/pyro/distributions/torch_distribution.py:48</span>, in <span class="ansi-cyan-fg">TorchDistributionMixin.__call__</span><span class="ansi-blue-fg">(self, sample_shape)</span>
<span class="ansi-green-intense-fg ansi-bold">     30</span> def __call__(self, sample_shape=torch.Size()):
<span class="ansi-green-intense-fg ansi-bold">     31</span>     &#34;&#34;&#34;
<span class="ansi-green-intense-fg ansi-bold">     32</span>     Samples a random value.
<span class="ansi-green-intense-fg ansi-bold">     33</span>
<span class="ansi-green-fg">   (...)</span>
<span class="ansi-green-intense-fg ansi-bold">     45</span>     :rtype: torch.Tensor
<span class="ansi-green-intense-fg ansi-bold">     46</span>     &#34;&#34;&#34;
<span class="ansi-green-intense-fg ansi-bold">     47</span>     return (
<span class="ansi-green-fg">---&gt; 48</span>         self.rsample(sample_shape)
<span class="ansi-green-intense-fg ansi-bold">     49</span>         if self.has_rsample
<span class="ansi-green-intense-fg ansi-bold">     50</span>         else self.sample(sample_shape)
<span class="ansi-green-intense-fg ansi-bold">     51</span>     )

File <span class="ansi-green-fg">~/anaconda3/envs/spFA/lib/python3.11/site-packages/torch/distributions/independent.py:96</span>, in <span class="ansi-cyan-fg">Independent.rsample</span><span class="ansi-blue-fg">(self, sample_shape)</span>
<span class="ansi-green-intense-fg ansi-bold">     95</span> def rsample(self, sample_shape=torch.Size()):
<span class="ansi-green-fg">---&gt; 96</span>     return self.base_dist.rsample(sample_shape)

File <span class="ansi-green-fg">~/anaconda3/envs/spFA/lib/python3.11/site-packages/torch/distributions/normal.py:74</span>, in <span class="ansi-cyan-fg">Normal.rsample</span><span class="ansi-blue-fg">(self, sample_shape)</span>
<span class="ansi-green-intense-fg ansi-bold">     72</span> def rsample(self, sample_shape=torch.Size()):
<span class="ansi-green-intense-fg ansi-bold">     73</span>     shape = self._extended_shape(sample_shape)
<span class="ansi-green-fg">---&gt; 74</span>     eps = _standard_normal(shape, dtype=self.loc.dtype, device=self.loc.device)
<span class="ansi-green-intense-fg ansi-bold">     75</span>     return self.loc + eps * self.scale

File <span class="ansi-green-fg">~/anaconda3/envs/spFA/lib/python3.11/site-packages/torch/distributions/utils.py:48</span>, in <span class="ansi-cyan-fg">_standard_normal</span><span class="ansi-blue-fg">(shape, dtype, device)</span>
<span class="ansi-green-intense-fg ansi-bold">     44</span> if torch._C._get_tracing_state():
<span class="ansi-green-intense-fg ansi-bold">     45</span>     # [JIT WORKAROUND] lack of support for .normal_()
<span class="ansi-green-intense-fg ansi-bold">     46</span>     return torch.normal(torch.zeros(shape, dtype=dtype, device=device),
<span class="ansi-green-intense-fg ansi-bold">     47</span>                         torch.ones(shape, dtype=dtype, device=device))
<span class="ansi-green-fg">---&gt; 48</span> return torch.empty(shape, dtype=dtype, device=device).normal_()

<span class="ansi-red-fg">KeyboardInterrupt</span>:
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>plt.semilogy(model.history)
plt.show()
plt.close()
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_tcga_data_10_0.png" src="../_images/notebooks_tcga_data_10_0.png" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span># plot fits
spfa.pl.plot_fit(model, view=0)
plt.show()
plt.close()
spfa.pl.plot_fit(model, view=1)
plt.show()
plt.close()
spfa.pl.plot_fit(model, view=2)
plt.show()
plt.close()
spfa.pl.plot_fit(model, view=3)
plt.show()
plt.close()
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_tcga_data_11_0.png" src="../_images/notebooks_tcga_data_11_0.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_tcga_data_11_1.png" src="../_images/notebooks_tcga_data_11_1.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_tcga_data_11_2.png" src="../_images/notebooks_tcga_data_11_2.png" />
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_tcga_data_11_3.png" src="../_images/notebooks_tcga_data_11_3.png" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>Z_pred = model.Z

df = pd.DataFrame(Z_pred, columns=[f&quot;Factor_{i+1}&quot; for i in range(Z_pred.shape[1])])
df[&quot;Subtype&quot;] = subtype[&quot;x&quot;].values

# pair plot of all factors colored according to subtype
sns.set(font_scale=1.2)
sns.pairplot(df, vars=df.columns[:-1], hue=&quot;Subtype&quot;, palette=&quot;colorblind&quot;)
plt.show()
plt.close()
matplotlib.rcParams.update(matplotlib.rcParamsDefault)
<br/></pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
/home/tuemay/anaconda3/envs/spFA/lib/python3.11/site-packages/seaborn/_oldcore.py:1498: FutureWarning: is_categorical_dtype is deprecated and will be removed in a future version. Use isinstance(dtype, CategoricalDtype) instead
  if pd.api.types.is_categorical_dtype(vector):
/home/tuemay/anaconda3/envs/spFA/lib/python3.11/site-packages/seaborn/_oldcore.py:1498: FutureWarning: is_categorical_dtype is deprecated and will be removed in a future version. Use isinstance(dtype, CategoricalDtype) instead
  if pd.api.types.is_categorical_dtype(vector):
/home/tuemay/anaconda3/envs/spFA/lib/python3.11/site-packages/seaborn/_oldcore.py:1498: FutureWarning: is_categorical_dtype is deprecated and will be removed in a future version. Use isinstance(dtype, CategoricalDtype) instead
  if pd.api.types.is_categorical_dtype(vector):
/home/tuemay/anaconda3/envs/spFA/lib/python3.11/site-packages/seaborn/_oldcore.py:1498: FutureWarning: is_categorical_dtype is deprecated and will be removed in a future version. Use isinstance(dtype, CategoricalDtype) instead
  if pd.api.types.is_categorical_dtype(vector):
/home/tuemay/anaconda3/envs/spFA/lib/python3.11/site-packages/seaborn/_oldcore.py:1498: FutureWarning: is_categorical_dtype is deprecated and will be removed in a future version. Use isinstance(dtype, CategoricalDtype) instead
  if pd.api.types.is_categorical_dtype(vector):
/home/tuemay/anaconda3/envs/spFA/lib/python3.11/site-packages/seaborn/_oldcore.py:1498: FutureWarning: is_categorical_dtype is deprecated and will be removed in a future version. Use isinstance(dtype, CategoricalDtype) instead
  if pd.api.types.is_categorical_dtype(vector):
/home/tuemay/anaconda3/envs/spFA/lib/python3.11/site-packages/seaborn/_oldcore.py:1498: FutureWarning: is_categorical_dtype is deprecated and will be removed in a future version. Use isinstance(dtype, CategoricalDtype) instead
  if pd.api.types.is_categorical_dtype(vector):
/home/tuemay/anaconda3/envs/spFA/lib/python3.11/site-packages/seaborn/_oldcore.py:1498: FutureWarning: is_categorical_dtype is deprecated and will be removed in a future version. Use isinstance(dtype, CategoricalDtype) instead
  if pd.api.types.is_categorical_dtype(vector):
/home/tuemay/anaconda3/envs/spFA/lib/python3.11/site-packages/seaborn/_oldcore.py:1498: FutureWarning: is_categorical_dtype is deprecated and will be removed in a future version. Use isinstance(dtype, CategoricalDtype) instead
  if pd.api.types.is_categorical_dtype(vector):
/home/tuemay/anaconda3/envs/spFA/lib/python3.11/site-packages/seaborn/_oldcore.py:1498: FutureWarning: is_categorical_dtype is deprecated and will be removed in a future version. Use isinstance(dtype, CategoricalDtype) instead
  if pd.api.types.is_categorical_dtype(vector):
/home/tuemay/anaconda3/envs/spFA/lib/python3.11/site-packages/seaborn/_oldcore.py:1119: FutureWarning: use_inf_as_na option is deprecated and will be removed in a future version. Convert inf values to NaN before operating instead.
  with pd.option_context(&#39;mode.use_inf_as_na&#39;, True):
/home/tuemay/anaconda3/envs/spFA/lib/python3.11/site-packages/seaborn/_oldcore.py:1498: FutureWarning: is_categorical_dtype is deprecated and will be removed in a future version. Use isinstance(dtype, CategoricalDtype) instead
  if pd.api.types.is_categorical_dtype(vector):
/home/tuemay/anaconda3/envs/spFA/lib/python3.11/site-packages/seaborn/_oldcore.py:1498: FutureWarning: is_categorical_dtype is deprecated and will be removed in a future version. Use isinstance(dtype, CategoricalDtype) instead
  if pd.api.types.is_categorical_dtype(vector):
/home/tuemay/anaconda3/envs/spFA/lib/python3.11/site-packages/seaborn/_oldcore.py:1498: FutureWarning: is_categorical_dtype is deprecated and will be removed in a future version. Use isinstance(dtype, CategoricalDtype) instead
  if pd.api.types.is_categorical_dtype(vector):
/home/tuemay/anaconda3/envs/spFA/lib/python3.11/site-packages/seaborn/_oldcore.py:1119: FutureWarning: use_inf_as_na option is deprecated and will be removed in a future version. Convert inf values to NaN before operating instead.
  with pd.option_context(&#39;mode.use_inf_as_na&#39;, True):
/home/tuemay/anaconda3/envs/spFA/lib/python3.11/site-packages/seaborn/_oldcore.py:1498: FutureWarning: is_categorical_dtype is deprecated and will be removed in a future version. Use isinstance(dtype, CategoricalDtype) instead
  if pd.api.types.is_categorical_dtype(vector):
/home/tuemay/anaconda3/envs/spFA/lib/python3.11/site-packages/seaborn/_oldcore.py:1498: FutureWarning: is_categorical_dtype is deprecated and will be removed in a future version. Use isinstance(dtype, CategoricalDtype) instead
  if pd.api.types.is_categorical_dtype(vector):
/home/tuemay/anaconda3/envs/spFA/lib/python3.11/site-packages/seaborn/_oldcore.py:1498: FutureWarning: is_categorical_dtype is deprecated and will be removed in a future version. Use isinstance(dtype, CategoricalDtype) instead
  if pd.api.types.is_categorical_dtype(vector):
/home/tuemay/anaconda3/envs/spFA/lib/python3.11/site-packages/seaborn/_oldcore.py:1119: FutureWarning: use_inf_as_na option is deprecated and will be removed in a future version. Convert inf values to NaN before operating instead.
  with pd.option_context(&#39;mode.use_inf_as_na&#39;, True):
/home/tuemay/anaconda3/envs/spFA/lib/python3.11/site-packages/seaborn/_oldcore.py:1498: FutureWarning: is_categorical_dtype is deprecated and will be removed in a future version. Use isinstance(dtype, CategoricalDtype) instead
  if pd.api.types.is_categorical_dtype(vector):
/home/tuemay/anaconda3/envs/spFA/lib/python3.11/site-packages/seaborn/_oldcore.py:1498: FutureWarning: is_categorical_dtype is deprecated and will be removed in a future version. Use isinstance(dtype, CategoricalDtype) instead
  if pd.api.types.is_categorical_dtype(vector):
/home/tuemay/anaconda3/envs/spFA/lib/python3.11/site-packages/seaborn/_oldcore.py:1498: FutureWarning: is_categorical_dtype is deprecated and will be removed in a future version. Use isinstance(dtype, CategoricalDtype) instead
  if pd.api.types.is_categorical_dtype(vector):
/home/tuemay/anaconda3/envs/spFA/lib/python3.11/site-packages/seaborn/_oldcore.py:1119: FutureWarning: use_inf_as_na option is deprecated and will be removed in a future version. Convert inf values to NaN before operating instead.
  with pd.option_context(&#39;mode.use_inf_as_na&#39;, True):
/home/tuemay/anaconda3/envs/spFA/lib/python3.11/site-packages/seaborn/_oldcore.py:1498: FutureWarning: is_categorical_dtype is deprecated and will be removed in a future version. Use isinstance(dtype, CategoricalDtype) instead
  if pd.api.types.is_categorical_dtype(vector):
/home/tuemay/anaconda3/envs/spFA/lib/python3.11/site-packages/seaborn/_oldcore.py:1498: FutureWarning: is_categorical_dtype is deprecated and will be removed in a future version. Use isinstance(dtype, CategoricalDtype) instead
  if pd.api.types.is_categorical_dtype(vector):
/home/tuemay/anaconda3/envs/spFA/lib/python3.11/site-packages/seaborn/_oldcore.py:1498: FutureWarning: is_categorical_dtype is deprecated and will be removed in a future version. Use isinstance(dtype, CategoricalDtype) instead
  if pd.api.types.is_categorical_dtype(vector):
/home/tuemay/anaconda3/envs/spFA/lib/python3.11/site-packages/seaborn/_oldcore.py:1119: FutureWarning: use_inf_as_na option is deprecated and will be removed in a future version. Convert inf values to NaN before operating instead.
  with pd.option_context(&#39;mode.use_inf_as_na&#39;, True):
/home/tuemay/anaconda3/envs/spFA/lib/python3.11/site-packages/seaborn/_oldcore.py:1498: FutureWarning: is_categorical_dtype is deprecated and will be removed in a future version. Use isinstance(dtype, CategoricalDtype) instead
  if pd.api.types.is_categorical_dtype(vector):
/home/tuemay/anaconda3/envs/spFA/lib/python3.11/site-packages/seaborn/_oldcore.py:1498: FutureWarning: is_categorical_dtype is deprecated and will be removed in a future version. Use isinstance(dtype, CategoricalDtype) instead
  if pd.api.types.is_categorical_dtype(vector):
/home/tuemay/anaconda3/envs/spFA/lib/python3.11/site-packages/seaborn/_oldcore.py:1498: FutureWarning: is_categorical_dtype is deprecated and will be removed in a future version. Use isinstance(dtype, CategoricalDtype) instead
  if pd.api.types.is_categorical_dtype(vector):
/home/tuemay/anaconda3/envs/spFA/lib/python3.11/site-packages/seaborn/_oldcore.py:1498: FutureWarning: is_categorical_dtype is deprecated and will be removed in a future version. Use isinstance(dtype, CategoricalDtype) instead
  if pd.api.types.is_categorical_dtype(vector):
/home/tuemay/anaconda3/envs/spFA/lib/python3.11/site-packages/seaborn/_oldcore.py:1498: FutureWarning: is_categorical_dtype is deprecated and will be removed in a future version. Use isinstance(dtype, CategoricalDtype) instead
  if pd.api.types.is_categorical_dtype(vector):
/home/tuemay/anaconda3/envs/spFA/lib/python3.11/site-packages/seaborn/_oldcore.py:1498: FutureWarning: is_categorical_dtype is deprecated and will be removed in a future version. Use isinstance(dtype, CategoricalDtype) instead
  if pd.api.types.is_categorical_dtype(vector):
/home/tuemay/anaconda3/envs/spFA/lib/python3.11/site-packages/seaborn/_oldcore.py:1498: FutureWarning: is_categorical_dtype is deprecated and will be removed in a future version. Use isinstance(dtype, CategoricalDtype) instead
  if pd.api.types.is_categorical_dtype(vector):
/home/tuemay/anaconda3/envs/spFA/lib/python3.11/site-packages/seaborn/_oldcore.py:1498: FutureWarning: is_categorical_dtype is deprecated and will be removed in a future version. Use isinstance(dtype, CategoricalDtype) instead
  if pd.api.types.is_categorical_dtype(vector):
/home/tuemay/anaconda3/envs/spFA/lib/python3.11/site-packages/seaborn/_oldcore.py:1498: FutureWarning: is_categorical_dtype is deprecated and will be removed in a future version. Use isinstance(dtype, CategoricalDtype) instead
  if pd.api.types.is_categorical_dtype(vector):
/home/tuemay/anaconda3/envs/spFA/lib/python3.11/site-packages/seaborn/_oldcore.py:1498: FutureWarning: is_categorical_dtype is deprecated and will be removed in a future version. Use isinstance(dtype, CategoricalDtype) instead
  if pd.api.types.is_categorical_dtype(vector):
/home/tuemay/anaconda3/envs/spFA/lib/python3.11/site-packages/seaborn/_oldcore.py:1498: FutureWarning: is_categorical_dtype is deprecated and will be removed in a future version. Use isinstance(dtype, CategoricalDtype) instead
  if pd.api.types.is_categorical_dtype(vector):
/home/tuemay/anaconda3/envs/spFA/lib/python3.11/site-packages/seaborn/_oldcore.py:1498: FutureWarning: is_categorical_dtype is deprecated and will be removed in a future version. Use isinstance(dtype, CategoricalDtype) instead
  if pd.api.types.is_categorical_dtype(vector):
/home/tuemay/anaconda3/envs/spFA/lib/python3.11/site-packages/seaborn/_oldcore.py:1498: FutureWarning: is_categorical_dtype is deprecated and will be removed in a future version. Use isinstance(dtype, CategoricalDtype) instead
  if pd.api.types.is_categorical_dtype(vector):
/home/tuemay/anaconda3/envs/spFA/lib/python3.11/site-packages/seaborn/_oldcore.py:1498: FutureWarning: is_categorical_dtype is deprecated and will be removed in a future version. Use isinstance(dtype, CategoricalDtype) instead
  if pd.api.types.is_categorical_dtype(vector):
/home/tuemay/anaconda3/envs/spFA/lib/python3.11/site-packages/seaborn/_oldcore.py:1498: FutureWarning: is_categorical_dtype is deprecated and will be removed in a future version. Use isinstance(dtype, CategoricalDtype) instead
  if pd.api.types.is_categorical_dtype(vector):
/home/tuemay/anaconda3/envs/spFA/lib/python3.11/site-packages/seaborn/_oldcore.py:1498: FutureWarning: is_categorical_dtype is deprecated and will be removed in a future version. Use isinstance(dtype, CategoricalDtype) instead
  if pd.api.types.is_categorical_dtype(vector):
/home/tuemay/anaconda3/envs/spFA/lib/python3.11/site-packages/seaborn/_oldcore.py:1498: FutureWarning: is_categorical_dtype is deprecated and will be removed in a future version. Use isinstance(dtype, CategoricalDtype) instead
  if pd.api.types.is_categorical_dtype(vector):
/home/tuemay/anaconda3/envs/spFA/lib/python3.11/site-packages/seaborn/_oldcore.py:1498: FutureWarning: is_categorical_dtype is deprecated and will be removed in a future version. Use isinstance(dtype, CategoricalDtype) instead
  if pd.api.types.is_categorical_dtype(vector):
/home/tuemay/anaconda3/envs/spFA/lib/python3.11/site-packages/seaborn/_oldcore.py:1498: FutureWarning: is_categorical_dtype is deprecated and will be removed in a future version. Use isinstance(dtype, CategoricalDtype) instead
  if pd.api.types.is_categorical_dtype(vector):
/home/tuemay/anaconda3/envs/spFA/lib/python3.11/site-packages/seaborn/_oldcore.py:1498: FutureWarning: is_categorical_dtype is deprecated and will be removed in a future version. Use isinstance(dtype, CategoricalDtype) instead
  if pd.api.types.is_categorical_dtype(vector):
/home/tuemay/anaconda3/envs/spFA/lib/python3.11/site-packages/seaborn/_oldcore.py:1498: FutureWarning: is_categorical_dtype is deprecated and will be removed in a future version. Use isinstance(dtype, CategoricalDtype) instead
  if pd.api.types.is_categorical_dtype(vector):
/home/tuemay/anaconda3/envs/spFA/lib/python3.11/site-packages/seaborn/_oldcore.py:1498: FutureWarning: is_categorical_dtype is deprecated and will be removed in a future version. Use isinstance(dtype, CategoricalDtype) instead
  if pd.api.types.is_categorical_dtype(vector):
/home/tuemay/anaconda3/envs/spFA/lib/python3.11/site-packages/seaborn/_oldcore.py:1498: FutureWarning: is_categorical_dtype is deprecated and will be removed in a future version. Use isinstance(dtype, CategoricalDtype) instead
  if pd.api.types.is_categorical_dtype(vector):
/home/tuemay/anaconda3/envs/spFA/lib/python3.11/site-packages/seaborn/_oldcore.py:1498: FutureWarning: is_categorical_dtype is deprecated and will be removed in a future version. Use isinstance(dtype, CategoricalDtype) instead
  if pd.api.types.is_categorical_dtype(vector):
/home/tuemay/anaconda3/envs/spFA/lib/python3.11/site-packages/seaborn/_oldcore.py:1498: FutureWarning: is_categorical_dtype is deprecated and will be removed in a future version. Use isinstance(dtype, CategoricalDtype) instead
  if pd.api.types.is_categorical_dtype(vector):
/home/tuemay/anaconda3/envs/spFA/lib/python3.11/site-packages/seaborn/_oldcore.py:1498: FutureWarning: is_categorical_dtype is deprecated and will be removed in a future version. Use isinstance(dtype, CategoricalDtype) instead
  if pd.api.types.is_categorical_dtype(vector):
/home/tuemay/anaconda3/envs/spFA/lib/python3.11/site-packages/seaborn/_oldcore.py:1498: FutureWarning: is_categorical_dtype is deprecated and will be removed in a future version. Use isinstance(dtype, CategoricalDtype) instead
  if pd.api.types.is_categorical_dtype(vector):
/home/tuemay/anaconda3/envs/spFA/lib/python3.11/site-packages/seaborn/_oldcore.py:1498: FutureWarning: is_categorical_dtype is deprecated and will be removed in a future version. Use isinstance(dtype, CategoricalDtype) instead
  if pd.api.types.is_categorical_dtype(vector):
/home/tuemay/anaconda3/envs/spFA/lib/python3.11/site-packages/seaborn/_oldcore.py:1498: FutureWarning: is_categorical_dtype is deprecated and will be removed in a future version. Use isinstance(dtype, CategoricalDtype) instead
  if pd.api.types.is_categorical_dtype(vector):
/home/tuemay/anaconda3/envs/spFA/lib/python3.11/site-packages/seaborn/_oldcore.py:1498: FutureWarning: is_categorical_dtype is deprecated and will be removed in a future version. Use isinstance(dtype, CategoricalDtype) instead
  if pd.api.types.is_categorical_dtype(vector):
/home/tuemay/anaconda3/envs/spFA/lib/python3.11/site-packages/seaborn/_oldcore.py:1498: FutureWarning: is_categorical_dtype is deprecated and will be removed in a future version. Use isinstance(dtype, CategoricalDtype) instead
  if pd.api.types.is_categorical_dtype(vector):
/home/tuemay/anaconda3/envs/spFA/lib/python3.11/site-packages/seaborn/_oldcore.py:1498: FutureWarning: is_categorical_dtype is deprecated and will be removed in a future version. Use isinstance(dtype, CategoricalDtype) instead
  if pd.api.types.is_categorical_dtype(vector):
/home/tuemay/anaconda3/envs/spFA/lib/python3.11/site-packages/seaborn/_oldcore.py:1498: FutureWarning: is_categorical_dtype is deprecated and will be removed in a future version. Use isinstance(dtype, CategoricalDtype) instead
  if pd.api.types.is_categorical_dtype(vector):
/home/tuemay/anaconda3/envs/spFA/lib/python3.11/site-packages/seaborn/_oldcore.py:1498: FutureWarning: is_categorical_dtype is deprecated and will be removed in a future version. Use isinstance(dtype, CategoricalDtype) instead
  if pd.api.types.is_categorical_dtype(vector):
/home/tuemay/anaconda3/envs/spFA/lib/python3.11/site-packages/seaborn/_oldcore.py:1498: FutureWarning: is_categorical_dtype is deprecated and will be removed in a future version. Use isinstance(dtype, CategoricalDtype) instead
  if pd.api.types.is_categorical_dtype(vector):
/home/tuemay/anaconda3/envs/spFA/lib/python3.11/site-packages/seaborn/_oldcore.py:1498: FutureWarning: is_categorical_dtype is deprecated and will be removed in a future version. Use isinstance(dtype, CategoricalDtype) instead
  if pd.api.types.is_categorical_dtype(vector):
/home/tuemay/anaconda3/envs/spFA/lib/python3.11/site-packages/seaborn/_oldcore.py:1498: FutureWarning: is_categorical_dtype is deprecated and will be removed in a future version. Use isinstance(dtype, CategoricalDtype) instead
  if pd.api.types.is_categorical_dtype(vector):
/home/tuemay/anaconda3/envs/spFA/lib/python3.11/site-packages/seaborn/_oldcore.py:1498: FutureWarning: is_categorical_dtype is deprecated and will be removed in a future version. Use isinstance(dtype, CategoricalDtype) instead
  if pd.api.types.is_categorical_dtype(vector):
/home/tuemay/anaconda3/envs/spFA/lib/python3.11/site-packages/seaborn/_oldcore.py:1498: FutureWarning: is_categorical_dtype is deprecated and will be removed in a future version. Use isinstance(dtype, CategoricalDtype) instead
  if pd.api.types.is_categorical_dtype(vector):
/home/tuemay/anaconda3/envs/spFA/lib/python3.11/site-packages/seaborn/_oldcore.py:1498: FutureWarning: is_categorical_dtype is deprecated and will be removed in a future version. Use isinstance(dtype, CategoricalDtype) instead
  if pd.api.types.is_categorical_dtype(vector):
/home/tuemay/anaconda3/envs/spFA/lib/python3.11/site-packages/seaborn/_oldcore.py:1498: FutureWarning: is_categorical_dtype is deprecated and will be removed in a future version. Use isinstance(dtype, CategoricalDtype) instead
  if pd.api.types.is_categorical_dtype(vector):
/home/tuemay/anaconda3/envs/spFA/lib/python3.11/site-packages/seaborn/_oldcore.py:1498: FutureWarning: is_categorical_dtype is deprecated and will be removed in a future version. Use isinstance(dtype, CategoricalDtype) instead
  if pd.api.types.is_categorical_dtype(vector):
/home/tuemay/anaconda3/envs/spFA/lib/python3.11/site-packages/seaborn/_oldcore.py:1498: FutureWarning: is_categorical_dtype is deprecated and will be removed in a future version. Use isinstance(dtype, CategoricalDtype) instead
  if pd.api.types.is_categorical_dtype(vector):
/home/tuemay/anaconda3/envs/spFA/lib/python3.11/site-packages/seaborn/_oldcore.py:1498: FutureWarning: is_categorical_dtype is deprecated and will be removed in a future version. Use isinstance(dtype, CategoricalDtype) instead
  if pd.api.types.is_categorical_dtype(vector):
/home/tuemay/anaconda3/envs/spFA/lib/python3.11/site-packages/seaborn/_oldcore.py:1498: FutureWarning: is_categorical_dtype is deprecated and will be removed in a future version. Use isinstance(dtype, CategoricalDtype) instead
  if pd.api.types.is_categorical_dtype(vector):
/home/tuemay/anaconda3/envs/spFA/lib/python3.11/site-packages/seaborn/_oldcore.py:1498: FutureWarning: is_categorical_dtype is deprecated and will be removed in a future version. Use isinstance(dtype, CategoricalDtype) instead
  if pd.api.types.is_categorical_dtype(vector):
/home/tuemay/anaconda3/envs/spFA/lib/python3.11/site-packages/seaborn/_oldcore.py:1498: FutureWarning: is_categorical_dtype is deprecated and will be removed in a future version. Use isinstance(dtype, CategoricalDtype) instead
  if pd.api.types.is_categorical_dtype(vector):
/home/tuemay/anaconda3/envs/spFA/lib/python3.11/site-packages/seaborn/_oldcore.py:1498: FutureWarning: is_categorical_dtype is deprecated and will be removed in a future version. Use isinstance(dtype, CategoricalDtype) instead
  if pd.api.types.is_categorical_dtype(vector):
/home/tuemay/anaconda3/envs/spFA/lib/python3.11/site-packages/seaborn/_oldcore.py:1498: FutureWarning: is_categorical_dtype is deprecated and will be removed in a future version. Use isinstance(dtype, CategoricalDtype) instead
  if pd.api.types.is_categorical_dtype(vector):
/home/tuemay/anaconda3/envs/spFA/lib/python3.11/site-packages/seaborn/_oldcore.py:1498: FutureWarning: is_categorical_dtype is deprecated and will be removed in a future version. Use isinstance(dtype, CategoricalDtype) instead
  if pd.api.types.is_categorical_dtype(vector):
/home/tuemay/anaconda3/envs/spFA/lib/python3.11/site-packages/seaborn/_oldcore.py:1498: FutureWarning: is_categorical_dtype is deprecated and will be removed in a future version. Use isinstance(dtype, CategoricalDtype) instead
  if pd.api.types.is_categorical_dtype(vector):
/home/tuemay/anaconda3/envs/spFA/lib/python3.11/site-packages/seaborn/_oldcore.py:1498: FutureWarning: is_categorical_dtype is deprecated and will be removed in a future version. Use isinstance(dtype, CategoricalDtype) instead
  if pd.api.types.is_categorical_dtype(vector):
/home/tuemay/anaconda3/envs/spFA/lib/python3.11/site-packages/seaborn/_oldcore.py:1498: FutureWarning: is_categorical_dtype is deprecated and will be removed in a future version. Use isinstance(dtype, CategoricalDtype) instead
  if pd.api.types.is_categorical_dtype(vector):
/home/tuemay/anaconda3/envs/spFA/lib/python3.11/site-packages/seaborn/_oldcore.py:1498: FutureWarning: is_categorical_dtype is deprecated and will be removed in a future version. Use isinstance(dtype, CategoricalDtype) instead
  if pd.api.types.is_categorical_dtype(vector):
/home/tuemay/anaconda3/envs/spFA/lib/python3.11/site-packages/seaborn/_oldcore.py:1498: FutureWarning: is_categorical_dtype is deprecated and will be removed in a future version. Use isinstance(dtype, CategoricalDtype) instead
  if pd.api.types.is_categorical_dtype(vector):
/home/tuemay/anaconda3/envs/spFA/lib/python3.11/site-packages/seaborn/_oldcore.py:1498: FutureWarning: is_categorical_dtype is deprecated and will be removed in a future version. Use isinstance(dtype, CategoricalDtype) instead
  if pd.api.types.is_categorical_dtype(vector):
/home/tuemay/anaconda3/envs/spFA/lib/python3.11/site-packages/seaborn/_oldcore.py:1498: FutureWarning: is_categorical_dtype is deprecated and will be removed in a future version. Use isinstance(dtype, CategoricalDtype) instead
  if pd.api.types.is_categorical_dtype(vector):
/home/tuemay/anaconda3/envs/spFA/lib/python3.11/site-packages/seaborn/_oldcore.py:1498: FutureWarning: is_categorical_dtype is deprecated and will be removed in a future version. Use isinstance(dtype, CategoricalDtype) instead
  if pd.api.types.is_categorical_dtype(vector):
/home/tuemay/anaconda3/envs/spFA/lib/python3.11/site-packages/seaborn/_oldcore.py:1498: FutureWarning: is_categorical_dtype is deprecated and will be removed in a future version. Use isinstance(dtype, CategoricalDtype) instead
  if pd.api.types.is_categorical_dtype(vector):
/home/tuemay/anaconda3/envs/spFA/lib/python3.11/site-packages/seaborn/_oldcore.py:1498: FutureWarning: is_categorical_dtype is deprecated and will be removed in a future version. Use isinstance(dtype, CategoricalDtype) instead
  if pd.api.types.is_categorical_dtype(vector):
/home/tuemay/anaconda3/envs/spFA/lib/python3.11/site-packages/seaborn/_oldcore.py:1498: FutureWarning: is_categorical_dtype is deprecated and will be removed in a future version. Use isinstance(dtype, CategoricalDtype) instead
  if pd.api.types.is_categorical_dtype(vector):
/home/tuemay/anaconda3/envs/spFA/lib/python3.11/site-packages/seaborn/_oldcore.py:1498: FutureWarning: is_categorical_dtype is deprecated and will be removed in a future version. Use isinstance(dtype, CategoricalDtype) instead
  if pd.api.types.is_categorical_dtype(vector):
/home/tuemay/anaconda3/envs/spFA/lib/python3.11/site-packages/seaborn/_oldcore.py:1498: FutureWarning: is_categorical_dtype is deprecated and will be removed in a future version. Use isinstance(dtype, CategoricalDtype) instead
  if pd.api.types.is_categorical_dtype(vector):
/home/tuemay/anaconda3/envs/spFA/lib/python3.11/site-packages/seaborn/_oldcore.py:1498: FutureWarning: is_categorical_dtype is deprecated and will be removed in a future version. Use isinstance(dtype, CategoricalDtype) instead
  if pd.api.types.is_categorical_dtype(vector):
/home/tuemay/anaconda3/envs/spFA/lib/python3.11/site-packages/seaborn/_oldcore.py:1498: FutureWarning: is_categorical_dtype is deprecated and will be removed in a future version. Use isinstance(dtype, CategoricalDtype) instead
  if pd.api.types.is_categorical_dtype(vector):
/home/tuemay/anaconda3/envs/spFA/lib/python3.11/site-packages/seaborn/_oldcore.py:1498: FutureWarning: is_categorical_dtype is deprecated and will be removed in a future version. Use isinstance(dtype, CategoricalDtype) instead
  if pd.api.types.is_categorical_dtype(vector):
/home/tuemay/anaconda3/envs/spFA/lib/python3.11/site-packages/seaborn/_oldcore.py:1498: FutureWarning: is_categorical_dtype is deprecated and will be removed in a future version. Use isinstance(dtype, CategoricalDtype) instead
  if pd.api.types.is_categorical_dtype(vector):
/home/tuemay/anaconda3/envs/spFA/lib/python3.11/site-packages/seaborn/_oldcore.py:1498: FutureWarning: is_categorical_dtype is deprecated and will be removed in a future version. Use isinstance(dtype, CategoricalDtype) instead
  if pd.api.types.is_categorical_dtype(vector):
/home/tuemay/anaconda3/envs/spFA/lib/python3.11/site-packages/seaborn/_oldcore.py:1498: FutureWarning: is_categorical_dtype is deprecated and will be removed in a future version. Use isinstance(dtype, CategoricalDtype) instead
  if pd.api.types.is_categorical_dtype(vector):
/home/tuemay/anaconda3/envs/spFA/lib/python3.11/site-packages/seaborn/_oldcore.py:1498: FutureWarning: is_categorical_dtype is deprecated and will be removed in a future version. Use isinstance(dtype, CategoricalDtype) instead
  if pd.api.types.is_categorical_dtype(vector):
/home/tuemay/anaconda3/envs/spFA/lib/python3.11/site-packages/seaborn/_oldcore.py:1498: FutureWarning: is_categorical_dtype is deprecated and will be removed in a future version. Use isinstance(dtype, CategoricalDtype) instead
  if pd.api.types.is_categorical_dtype(vector):
/home/tuemay/anaconda3/envs/spFA/lib/python3.11/site-packages/seaborn/_oldcore.py:1498: FutureWarning: is_categorical_dtype is deprecated and will be removed in a future version. Use isinstance(dtype, CategoricalDtype) instead
  if pd.api.types.is_categorical_dtype(vector):
/home/tuemay/anaconda3/envs/spFA/lib/python3.11/site-packages/seaborn/_oldcore.py:1498: FutureWarning: is_categorical_dtype is deprecated and will be removed in a future version. Use isinstance(dtype, CategoricalDtype) instead
  if pd.api.types.is_categorical_dtype(vector):
/home/tuemay/anaconda3/envs/spFA/lib/python3.11/site-packages/seaborn/_oldcore.py:1498: FutureWarning: is_categorical_dtype is deprecated and will be removed in a future version. Use isinstance(dtype, CategoricalDtype) instead
  if pd.api.types.is_categorical_dtype(vector):
/home/tuemay/anaconda3/envs/spFA/lib/python3.11/site-packages/seaborn/_oldcore.py:1498: FutureWarning: is_categorical_dtype is deprecated and will be removed in a future version. Use isinstance(dtype, CategoricalDtype) instead
  if pd.api.types.is_categorical_dtype(vector):
/home/tuemay/anaconda3/envs/spFA/lib/python3.11/site-packages/seaborn/_oldcore.py:1498: FutureWarning: is_categorical_dtype is deprecated and will be removed in a future version. Use isinstance(dtype, CategoricalDtype) instead
  if pd.api.types.is_categorical_dtype(vector):
/home/tuemay/anaconda3/envs/spFA/lib/python3.11/site-packages/seaborn/_oldcore.py:1498: FutureWarning: is_categorical_dtype is deprecated and will be removed in a future version. Use isinstance(dtype, CategoricalDtype) instead
  if pd.api.types.is_categorical_dtype(vector):
/home/tuemay/anaconda3/envs/spFA/lib/python3.11/site-packages/seaborn/_oldcore.py:1498: FutureWarning: is_categorical_dtype is deprecated and will be removed in a future version. Use isinstance(dtype, CategoricalDtype) instead
  if pd.api.types.is_categorical_dtype(vector):
/home/tuemay/anaconda3/envs/spFA/lib/python3.11/site-packages/seaborn/_oldcore.py:1498: FutureWarning: is_categorical_dtype is deprecated and will be removed in a future version. Use isinstance(dtype, CategoricalDtype) instead
  if pd.api.types.is_categorical_dtype(vector):
/home/tuemay/anaconda3/envs/spFA/lib/python3.11/site-packages/seaborn/_oldcore.py:1498: FutureWarning: is_categorical_dtype is deprecated and will be removed in a future version. Use isinstance(dtype, CategoricalDtype) instead
  if pd.api.types.is_categorical_dtype(vector):
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_tcga_data_12_1.png" src="../_images/notebooks_tcga_data_12_1.png" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><br/><span></span>spfa.pl.plot_weights(model, view=0, factor=4)
plt.show()
<br/></pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
/home/tuemay/anaconda3/envs/spFA/lib/python3.11/site-packages/spfa/plots/plots.py:50: FutureWarning: Series.__getitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To access a value by position, use `ser.iloc[pos]`
  ax.annotate(txt, (x[i], W_sorted[i]))
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_tcga_data_13_1.png" src="../_images/notebooks_tcga_data_13_1.png" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span># plot top 20 weights of factor 1 and proteomics data (factor 0 corresponds to the first factor)
spfa.pl.plot_top_weights(model, view=3, factor=1,top_n=20 ,sign=&quot;+&quot;)
plt.show()
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
/home/tuemay/anaconda3/envs/spFA/lib/python3.11/site-packages/spfa/plots/plots.py:123: FutureWarning: Series.__getitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To access a value by position, use `ser.iloc[pos]`
  ax.annotate(&#34;+&#34;, (topW[i]+signoffset,i+0.7), fontsize=12)
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_tcga_data_14_1.png" src="../_images/notebooks_tcga_data_14_1.png" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><br/><span></span>spfa.pl.plot_variance_explained_view(model)
plt.show()
<br/></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_tcga_data_15_0.png" src="../_images/notebooks_tcga_data_15_0.png" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><br/><span></span>spfa.pl.plot_variance_explained(model)
plt.show()
<br/></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_tcga_data_16_0.png" src="../_images/notebooks_tcga_data_16_0.png" />
</div>
</div>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="installation.html" class="btn btn-neutral float-left" title="Installation" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="cll_data.html" class="btn btn-neutral float-right" title="Analysis of multi-omics data of chronic lymphocytic leukemia patients" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2023, Tuemay Capraz.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>